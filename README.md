# 🎓 SDUW Course Assistant (山大威海选课助手)

一个专为 **山东大学（威海）教务系统** 设计的浏览器控制台脚本。
旨在解决选课过程中常见的“按钮消失”、“会话过期 (Unexpected token <)”、“需频繁翻页”等痛点，提供稳定、智能的辅助选课体验。


## ⚠️ 适用场景与警告 (Important)

**本脚本专为“回流课”蹲守（即捡漏）设计。**

* **核心用途**：适用于课程已满员，需要长时间挂机等待有人退课（释放名额）的场景。
* **使用禁忌**：**不建议**在选课系统刚开放的“秒杀”阶段（全校高并发期）使用。此时系统负载极高，使用脚本的高频请求极易导致 IP 被封禁或账号被锁。
* **建议频率**：捡漏模式下，请务必将刷新间隔设置在 **1500ms** 以上，保持低调长续航。

---

---

## ⚠️ 免责声明 (Disclaimer)

1.  **仅供学习交流**：本项目仅用于技术研究和学习 JavaScript DOM 操作，**严禁用于任何商业用途**。
2.  **风险自负**：使用脚本可能违反学校教务系统的使用规定。请用户自行承担因使用本脚本可能导致的账号封禁、选课失败或行政处分等风险。
3.  **合理使用**：请务必将刷新频率设置在 **1500ms** 以上，避免对学校服务器造成压力。

---

## ✨ 核心功能

* **🔍 智能双重保险**：
    * **自动搜索**：自动寻找输入框填入课程号并查询，精准定位课程。
    * **强制展开**：若搜索失败，自动强制将表格扩展至 **200行/页**，确保课程在第一页可见，无需翻页。
* **🛡️ 动态防卡死**：
    * 当检测到“选课”按钮因系统拥堵消失时，自动触发“查询重置”机制，救回死锁的页面，实现无人值守。
* **💓 掉线检测**：
    * 实时监控会话状态，一旦检测到 Session 过期（Welcome 登录页），立即报警提示。
* **🚫 弹窗拦截**：
    * 自动屏蔽选课失败的弹窗，成功时自动停止并高亮提醒。

---

## 🚀 快速开始

### 1. 准备工作
* 浏览器：推荐使用 **Microsoft Edge** 或 **Google Chrome**。
* 登录：进入 [山东大学（威海）教务系统](http://bkzhjx.wh.sdu.edu.cn/)，并打开 **“必修选课”** 或 **“任选/限选”** 页面。

### 2. 运行脚本
1.  在选课页面，按下键盘上的 **`F12`** 键（或右键 -> 检查）。
2.  点击 **“控制台” (Console)** 标签页。
3.  在顶部点击**top**选择**selectTable()getBxxkxx**按钮
<img width="406" height="445" alt="image" src="https://github.com/user-attachments/assets/cd88842c-524c-44e0-a71c-b2b9cf253d33" />

4.  复制 [`script.js`](./script.js) 中的所有代码。
5.  粘贴到控制台，按下 **`Enter`** 回车运行。

### 3. 配置参数
脚本启动后会依次弹出输入框，请按需填写：

| 参数 | 示例 | 说明 |
| :--- | :--- | :--- |
| **课程编号** | `sd116100A0` | 必须精准，脚本依据此编号搜索或定位。 |
| **课序号** | `301` | 具体的班级号，防止选错老师。 |
| **点击间隔** | `1500` | **强烈建议 1500ms**。低于 800ms 极易被封 IP。 |

---

## 🛠️ 运行机制说明

脚本运行后将自动执行以下逻辑：

1.  **初始化检查**：尝试自动在页面中寻找“课程号”输入框。
    * **成功**：自动填入编号 -> 点击查询 -> 表格刷新为单行结果。
    * **失败**：自动执行 `DataTables` 指令 -> 强制显示 200 条数据 -> 确保课程可见。
2.  **循环抢课**：
    * **正常模式**：每隔 1.5秒 点击一次“选课”。
    * **异常模式**：若按钮消失，自动切换为 `查询 -> 等待 -> 选课` 循环模式。
3.  **成功停止**：
    * 一旦检测到抢课成功，脚本将停止运行，并刷新页面保存状态。

---

## ❓ 常见问题

**Q: 控制台报错 `undefined` 或 `Unexpected token`？**
A: 请确保复制了完整的代码（从 `(function(){` 到 `})();`）。如果是红色的网络请求报错，通常是教务系统自身的 Bug，只要脚本还在打印 `[点击]` 日志即可忽略。

**Q: 脚本提示“自动搜索失败”怎么办？**
A: 无需担心。脚本会自动启动“备用方案”，强制展开表格，你依然可以在第一页找到课程。

**Q: 可以同时开多个窗口抢不同的课吗？**
A: **不建议**。教务系统通常限制单点登录，多窗口操作容易导致 Session 冲突互相踢下线。建议一次抢一门。

---

## 📜 许可证

MIT License
